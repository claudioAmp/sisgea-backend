<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ob.unibanca.sicf.consultasgenerales.mapper.IIncomingVisa10Mapper">
			
	<sql id="consultaPorCriteriosTCR0" >
		SELECT *
		FROM VI_CON_MOV_INC_TC10_TCR0 a
	</sql>
	
	<sql id = "fragmentoWhereGet" >
		<if  test="fechaProcesoInicio != null and fechaProcesoFin != null">
			 a.FECHA_PROCESO BETWEEN #{fechaProcesoInicio}  AND #{fechaProcesoFin}
		</if>
		
	</sql>
	
	<sql id ="fragmentoWhereGetMultiples" >
		<if  test="transactionsCodes !=null and transactionsCodes.size()>0">
			AND a.TRANSACTION_CODE IN 
				<foreach item="item" index="index" collection="transactionsCodes" open ="(" separator="," close=")">
					#{item}
				</foreach>
		</if>
		<if  test="reasonSCodes != null and reasonSCodes.size()>0"  >
			AND a.REASON_CODE IN 
				<foreach item="item" index="index" collection="reasonSCodes" open ="(" separator=","  close=")">
					#{item}
				</foreach>
		</if>
		<if  test="destCurrenciesCodes != null and destCurrenciesCodes.size()>0" >
			AND a.DEST_CURRENCY_CODE IN 
				<foreach item="item" index="index" collection="destCurrenciesCodes" open ="(" separator=","  close=")">
					#{item}
				</foreach>
		</if>
		
	</sql>
	
	
	<select id="buscarPorCriteriosTCR0" parameterType="CriterioBusquedaIncomingVisaTC10"  resultType="CobroDesembolsoVisa" statementType="PREPARED">	
		<include refid="consultaPorCriteriosTCR0" />
			WHERE
		<include refid="fragmentoWhereGet" /> 
		<include refid="fragmentoWhereGetMultiples" />
   	</select>
   	
   	<sql id="framentoSelectTCR0" >
		SELECT 
			*
		FROM VIE_CON_MOV_INC_TC10_TCR0_DET a
	</sql>
  
	 
	 <select id="buscarPorIdSecuenciaTCR0" parameterType="CriterioBusquedaIncomingVisa" resultType="IncomingVisaTC10TCR0Det" statementType="PREPARED">		
		<include refid="framentoSelectTCR0" />
  		WHERE 
  		<if  test="idSecuenciaIncoming != null " >
			SECUENCIA_INCOMING = #{idSecuenciaIncoming}
		</if>
   	</select>
	
	
   	
   	 
</mapper>
