<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ob.unibanca.sicf.consultasgenerales.mapper.IFacturaMasterCardMapper">
    <sql id="consultaFactura">
        SELECT *
            FROM VIE_CON_MOV_FACTURA_MC a
    </sql>
    
    <sql id = "fragmentoWhere">
		<if  test="billingCycleDateInicio != null and billingCycleDateFin != null">
			AND  a.BILLING_CYCLE_DATE BETWEEN #{billingCycleDateInicio}  AND #{billingCycleDateFin}
		</if>
		
		<if  test="eventId != null and eventId != ''">
			AND  a.EVENT_ID = #{eventId}
		</if>
	</sql>

	<select id="buscarPorCriterios" parameterType="CriterioBusquedaFacturaMasterCard"  resultType="FacturaMasterCard" statementType="PREPARED">	
		<include refid="consultaFactura" />
		<where>
			<include refid="fragmentoWhere"/> 

		</where>
   	</select>
 
</mapper>